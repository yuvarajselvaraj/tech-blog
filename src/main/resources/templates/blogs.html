<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{fragments/layout :: base('Laravel News Blogs', ~{::extraHead}, ~{::content})}">
<head>
  <th:block th:fragment="extraHead">
    <style>
      body { margin: 0; padding: 24px; background: #0b0d12; color: #eaeef3; }
      a { color: #7cc4ff; text-decoration: none; }
      a:hover { text-decoration: underline; }
      .container { max-width: 900px; margin: 0 auto; }
      h1 { margin: 0 0 16px; font-size: 28px; font-weight: 700; }
      .sub { color: #a9b4c0; margin-bottom: 24px; }
      .card { background: #121721; border: 1px solid #1c2432; border-radius: 12px; padding: 18px 20px; margin-bottom: 14px; }
      .title { font-size: 18px; margin: 0 0 6px; }
      .meta { color: #8aa0b2; font-size: 12px; margin-bottom: 10px; }
      .content { color: #d6dde5; font-size: 14px; line-height: 1.5; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 4; -webkit-box-orient: vertical; }
      .content img { max-width: 100%; max-height: 260px; width: auto; height: auto; object-fit: cover; border-radius: 8px; display: block; margin: 8px 0; }
      .pager { display: flex; align-items: center; justify-content: center; gap: 12px; margin: 20px 0 0; }
      .pager a, .pager span { padding: 8px 12px; border-radius: 8px; border: 1px solid #233048; background: #101622; color: #dbe7f3; }
      .pager a:hover { background: #162032; }
      .pager .disabled { opacity: 0.5; pointer-events: none; }
      .topbar { display: flex; align-items: center; justify-content: space-between; }
      .logout-btn { padding: 8px 12px; border-radius: 8px; border: 1px solid #233048; background: #101622; color: #dbe7f3; cursor: pointer; }
      .logout-btn:hover { background: #162032; }
    </style>
    <script>
      function formatDate(iso) {
        try { return new Date(iso).toLocaleString(); } catch(e) { return iso; }
      }
    </script>
  </th:block>
</head>
<body>
  <th:block th:fragment="content">
    <div class="container">
      <div class="topbar">
        <h1>Laravel News Blogs</h1>
        <form th:action="@{/logout}" method="post">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
          <button type="submit" class="logout-btn">Sign out</button>
        </form>
      </div>
      <div class="sub">Latest posts pulled from the Laravel News RSS feed.</div>

      <div th:if="${#lists.isEmpty(posts)}">No posts yet. The scheduler will fetch items shortly.</div>

      <div th:each="post : ${posts}" class="card">
        <div class="title">
          <a th:href="${post.link}" th:text="${post.title}" target="_blank" rel="noopener noreferrer">Title</a>
        </div>
        <div class="meta" th:text="${post.publishedAt}">2025-01-01T00:00:00Z</div>
        <div class="content" th:utext="${post.content}"></div>
      </div>

      <div class="pager" th:if="${totalPages} > 1">
        <a th:classappend="${!hasPrev} ? ' disabled'" th:href="@{'/blogs'(page=${currentPage - 1}, size=${size})}">Prev</a>
        <span th:text="${currentPage + 1} + ' / ' + ${totalPages}">1 / 5</span>
        <a th:classappend="${!hasNext} ? ' disabled'" th:href="@{'/blogs'(page=${currentPage + 1}, size=${size})}">Next</a>
      </div>
    </div>
  </th:block>
</body>
</html>

